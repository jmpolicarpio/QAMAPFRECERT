/*SELECT  COUNT(*)  -- PVPOL.nombre,SUVPOL.NOMBRE,count(*) --
FROM SGSM.dbo.TB_EMI_POLIZA P WITH(NOLOCK)
JOIN SGSM.dbo.TB_EMI_ITEM_POLIZA IPO WITH(NOLOCK) ON P.POLIZA_ID = IPO.POLIZA_ID AND IPO.NRO_RIESGO = 1
JOIN SGSM.dbo.TB_EMI_ASEGURADO ASE WITH(NOLOCK) ON IPO.ASEGURADO_ID = ASE.ASEGURADO_ID
JOIN SGSM.dbo.TB_ADM_PERSONA PASE WITH(NOLOCK) ON ASE.PERSONA_ID = PASE.PERSONA_ID
JOIN SGSM.dbo.TB_ADM_ESTADO ES WITH(NOLOCK) ON P.ESTADO_ID = ES.ESTADO_ID
JOIN SGSM.dbo.TB_ADM_VENDEDOR VE WITH(NOLOCK) ON P.VENDEDOR_ID = VE.VENDEDOR_ID
JOIN SGSM.dbo.TB_ADM_PUNTO_VENTA PVV WITH(NOLOCK) ON VE.PUNTO_VENTA_ID = PVV.PUNTO_VENTA_ID
JOIN SGSM.dbo.TB_ADM_SUCURSAL SUV WITH(NOLOCK) ON PVV.SUCURSAL_ID = SUV.SUCURSAL_ID
JOIN SGSM.dbo.TB_ADM_PUNTO_VENTA PVPOL WITH(NOLOCK) ON P.PUNTO_VENTA_ID = PVPOL.PUNTO_VENTA_ID
JOIN SGSM.dbo.TB_ADM_SUCURSAL SUVPOL WITH(NOLOCK) ON P.SUCURSAL_ID = SUVPOL.SUCURSAL_ID
WHERE P.CANAL_ID IN (11) 
group by PVPOL.nombre,SUVPOL.NOMBRE
order by 3 desc
select * from TB_ADM_SUCURSAL 
ORDER BY P.POLIZA_ID DESC

*/

--7	CAJA PAITA

SELECT *
FROM SGSM.dbo.TB_EMI_POLIZA P WITH(NOLOCK)
JOIN SGSM.dbo.TB_EMI_ITEM_POLIZA IPO WITH(NOLOCK) ON P.POLIZA_ID = IPO.POLIZA_ID AND PRODUCTO_ID IN ('204','205')
JOIN SGSM.dbo.TB_EMI_RIESGO_GRAL RG WITH(NOLOCK) ON  RG.POLIZA_ID=P.POLIZA_ID
JOIN SGSM.dbo.TB_ADM_DIRECCION AD WITH(NOLOCK) ON  AD.DIRECCION_ID=RG.DIRECCION_ID
WHERE P.CANAL_ID IN (7)  AND P.NRO_CERTIFICADO='0000000285'

--SELECT * FROM TB_EMI_ITEM_POLIZA
SELECT * FROM TB_ADM_PERSONA  WHERE PERSONA_ID=37924

SELECT * 
FROM MAPFREQOA.dbo.T_MAE_POLIZA P
JOIN MAPFREQOA.dbo.T_MAE_CERTIFICADO C ON P.N_ID_POLIZA = C.N_ID_POLIZA
JOIN MAPFREQOA.dbo.T_DET_DATOPARTICULARCERTIFICADO RC ON RC.N_ID_CERTIFICADO=C.N_ID_CERTIFICADO
WHERE P.N_ID_CANAL IN (8)  AND C_NUM_CERTIFICADO='0000000285'

SELECT * FROM MAPFREQOA.dbo.T_DET_ROLTERCEROCERTIFICADO WHERE N_ID_CERTIFICADO= 3957812
SELECT * FROM MAPFREQOA.dbo.T_MAE_TERCERO WHERE N_ID_TERCERO=346843



SELECT * FROM T_DET_DATOPARTICULARCERTIFICADO WHERE N_ID_CERTIFICADO= 3957812


SELECT * FROM T_DET_DATOPARTICULARCOTIZACION 
 
 
SELECT *
FROM SGSM.dbo.TB_EMI_POLIZA P WITH(NOLOCK)
JOIN SGSM.dbo.TB_EMI_ITEM_POLIZA IPO WITH(NOLOCK) ON P.POLIZA_ID = IPO.POLIZA_ID AND PRODUCTO_ID IN ('204','205')
JOIN SGSM.dbo.TB_EMI_RIESGO_GRAL RG WITH(NOLOCK) ON  RG.POLIZA_ID=P.POLIZA_ID
JOIN SGSM.dbo.TB_ADM_DIRECCION AD WITH(NOLOCK) ON  AD.DIRECCION_ID=RG.DIRECCION_ID
WHERE P.CANAL_ID IN (7)  AND P.NRO_CERTIFICADO='0000000285'

SELECT * FROM SGSM.dbo.TB_EMI_RIESGO_GRAL WHERE POLIZA_ID=343925
--SELECT * FROM TB_EMI_ITEM_POLIZA
--SELECT * FROM TB_ADM_PERSONA  WHERE PERSONA_ID=37924
SELECT * FROM MAPFREQOA.dbo.T_DET_DATOPARTICULARCERTIFICADO WHERE N_ID_CERTIFICADO= 3957812

SELECT * FROM T_MAE_TIPO where N_ID_TIPO=656


SELECT * 
FROM MAPFREQOA.dbo.T_MAE_POLIZA P
JOIN MAPFREQOA.dbo.T_MAE_CERTIFICADO C ON P.N_ID_POLIZA = C.N_ID_POLIZA
JOIN MAPFREQOA.dbo.T_DET_DATOPARTICULARCERTIFICADO RC ON RC.N_ID_CERTIFICADO=C.N_ID_CERTIFICADO
WHERE P.N_ID_CANAL IN (8)  AND C_NUM_CERTIFICADO='0000000285'






select * from TB_EMI_RIESGO_GRAL where POLIZA_ID=42316
select * from TB_ADM_DIRECCION where DIRECCION_ID=51750

SELECT * FROM TB_EMI_ITEM_POLIZA
select * from TB_PRD_PRODUCTO where PRODUCTO_ID IN (204,205)
SELECT * FROM TB_PRD_PLAN WHERE PRODUCTO_ID IN (204,205)

PLAN_ID	NOMBRE	PRODUCTO_ID
1781	INCENDIO PAITA SOLES	204
1782	INCENDIO PAITA SOLES	205

SELECT * FROM T_MAE_CANAL_PLAN WHERE N_ID_ENTIDAD=8
SELECT * FROM T_MAE_ENTIDAD

--POLIZAS MIGRADAS --179
SELECT P.CANAL_ID, COUNT(*) 
FROM SGSM.dbo.TB_EMI_POLIZA P WITH(NOLOCK)
JOIN SGSM.dbo.TB_EMI_ITEM_POLIZA IPO WITH(NOLOCK) ON P.POLIZA_ID = IPO.POLIZA_ID AND PRODUCTO_ID IN ('204','205')
WHERE P.CANAL_ID IN (7)  
group by P.CANAL_ID

SELECT P.N_ID_CANAL,COUNT(*) 
FROM MAPFREQOA.dbo.T_MAE_POLIZA P
JOIN MAPFREQOA.dbo.T_MAE_CERTIFICADO C ON P.N_ID_POLIZA = C.N_ID_POLIZA
WHERE P.N_ID_CANAL IN (8) 
GROUP BY P.N_ID_CANAL

--POLIZAS xNRO POLIZA
SELECT P.CANAL_ID, p.NRO_POLIZA, COUNT(*) 
FROM SGSM.dbo.TB_EMI_POLIZA P WITH(NOLOCK)
JOIN SGSM.dbo.TB_EMI_ITEM_POLIZA IPO WITH(NOLOCK) ON P.POLIZA_ID = IPO.POLIZA_ID AND IPO.NRO_RIESGO = 1
WHERE P.CANAL_ID IN (7) 
group by P.CANAL_ID,p.NRO_POLIZA
order by 1,2

SELECT P.N_ID_CANAL,p.c_num_poliza,COUNT(*) 
FROM MAPFREQOA.dbo.T_MAE_POLIZA P
JOIN MAPFREQOA.dbo.T_MAE_CERTIFICADO C ON P.N_ID_POLIZA = C.N_ID_POLIZA
WHERE P.N_ID_CANAL IN (8) 
GROUP BY P.N_ID_CANAL,p.c_num_poliza
order by 1,2


--POLIZAS x AÑO
SELECT P.CANAL_ID, year(p.FEC_EMITE), COUNT(*) 
FROM SGSM.dbo.TB_EMI_POLIZA P WITH(NOLOCK)
JOIN SGSM.dbo.TB_EMI_ITEM_POLIZA IPO WITH(NOLOCK) ON P.POLIZA_ID = IPO.POLIZA_ID AND PRODUCTO_ID IN ('204','205')
WHERE P.CANAL_ID IN (7) 
group by P.CANAL_ID,year(p.FEC_EMITE)
order by 1,2

SELECT P.N_ID_CANAL,year(p.D_FEC_POLIZA), COUNT(*) 
FROM MAPFREQOA.dbo.T_MAE_POLIZA P
JOIN MAPFREQOA.dbo.T_MAE_CERTIFICADO C ON P.N_ID_POLIZA = C.N_ID_POLIZA
WHERE P.N_ID_CANAL IN (8) 
GROUP BY P.N_ID_CANAL,year(p.D_FEC_POLIZA)
order by 1,2

--POLIZAS MIGRADAS CON ADICIONALES
SELECT  P.CANAL_ID, COUNT(*) 
FROM SGSM.dbo.TB_EMI_POLIZA P WITH(NOLOCK)
JOIN SGSM.dbo.TB_EMI_ITEM_POLIZA IPO WITH(NOLOCK) ON P.POLIZA_ID = IPO.POLIZA_ID AND PRODUCTO_ID IN ('204','205')
WHERE P.CANAL_ID IN (7) 
group by P.CANAL_ID


SELECT P.N_ID_CANAL,COUNT(*) 
FROM MAPFREQOA.dbo.T_MAE_POLIZA P
JOIN MAPFREQOA.dbo.T_MAE_CERTIFICADO C ON P.N_ID_POLIZA = C.N_ID_POLIZA
JOIN MAPFREQOA.dbo.T_DET_ROLTERCEROCERTIFICADO RC ON RC.N_ID_CERTIFICADO=C.N_ID_CERTIFICADO AND N_ID_TIPOASEGURADO <> 640
WHERE P.N_ID_CANAL IN (8) 
GROUP BY P.N_ID_CANAL


--SELECT P.CANAL_ID,PVPOL.nombre,count(*) --
--FROM SGSM.dbo.TB_EMI_POLIZA P WITH(NOLOCK)
--JOIN SGSM.dbo.TB_EMI_ITEM_POLIZA IPO WITH(NOLOCK) ON P.POLIZA_ID = IPO.POLIZA_ID AND IPO.NRO_RIESGO = 1
--JOIN SGSM.dbo.TB_ADM_PUNTO_VENTA PVPOL WITH(NOLOCK) ON P.PUNTO_VENTA_ID = PVPOL.PUNTO_VENTA_ID
----JOIN SGSM.dbo.TB_ADM_SUCURSAL SUVPOL WITH(NOLOCK) ON P.SUCURSAL_ID = SUVPOL.SUCURSAL_ID
--WHERE P.CANAL_ID IN (11) 
--group by P.CANAL_ID,PVPOL.nombre
--order by 2 desc

--AGRUPADOR POR OFICINA SULLANA
SELECT P.CANAL_ID,SUVPOL.nombre,count(*) --
FROM SGSM.dbo.TB_EMI_POLIZA P WITH(NOLOCK)
JOIN SGSM.dbo.TB_EMI_ITEM_POLIZA IPO WITH(NOLOCK) ON P.POLIZA_ID = IPO.POLIZA_ID AND PRODUCTO_ID IN ('204','205')
--JOIN SGSM.dbo.TB_ADM_PUNTO_VENTA PVPOL WITH(NOLOCK) ON P.PUNTO_VENTA_ID = PVPOL.PUNTO_VENTA_ID
JOIN SGSM.dbo.TB_ADM_SUCURSAL SUVPOL WITH(NOLOCK) ON P.SUCURSAL_ID = SUVPOL.SUCURSAL_ID
WHERE P.CANAL_ID IN (7) 
group by P.CANAL_ID,SUVPOL.nombre
order by 2 ASC

SELECT EST.C_NOM_ESTABLECIMIENTO,COUNT(*)
FROM MAPFREQOA.dbo.T_MAE_POLIZA P
JOIN MAPFREQOA.dbo.T_MAE_CERTIFICADO C ON P.N_ID_POLIZA = C.N_ID_POLIZA
JOIN MAPFREQOA.dbo.T_MAE_ESTABLECIMIENTO EST ON EST.N_ID_ESTABLECIMIENTO=P.N_ID_ESTABLECIMIENTO
WHERE P.N_ID_CANAL IN (8) 
GROUP BY EST.C_NOM_ESTABLECIMIENTO
order by 1 ASC

--AGRUPADOR POR OFICINA PIURA
SELECT P.CANAL_ID,SUVPOL.nombre,count(*) --
FROM SGSM.dbo.TB_EMI_POLIZA P WITH(NOLOCK)
JOIN SGSM.dbo.TB_EMI_ITEM_POLIZA IPO WITH(NOLOCK) ON P.POLIZA_ID = IPO.POLIZA_ID AND IPO.NRO_RIESGO = 1
--JOIN SGSM.dbo.TB_ADM_PUNTO_VENTA PVPOL WITH(NOLOCK) ON P.PUNTO_VENTA_ID = PVPOL.PUNTO_VENTA_ID
JOIN SGSM.dbo.TB_ADM_SUCURSAL SUVPOL WITH(NOLOCK) ON P.SUCURSAL_ID = SUVPOL.SUCURSAL_ID
WHERE P.CANAL_ID IN (12) 
group by P.CANAL_ID,SUVPOL.nombre
order by 2 ASC

SELECT EST.C_NOM_ESTABLECIMIENTO,COUNT(*)
FROM MAPFREQOA.dbo.T_MAE_POLIZA P
JOIN MAPFREQOA.dbo.T_MAE_CERTIFICADO C ON P.N_ID_POLIZA = C.N_ID_POLIZA
JOIN MAPFREQOA.dbo.T_MAE_ESTABLECIMIENTO EST ON EST.N_ID_ESTABLECIMIENTO=P.N_ID_ESTABLECIMIENTO
WHERE P.N_ID_CANAL IN (6) 
GROUP BY EST.C_NOM_ESTABLECIMIENTO
order by 1 ASC


--SELECT * FROM  MAPFREQOA.dbo.T_MAE_ESTABLECIMIENTO
--N_ID_ESTABLECIMIENTO

--select * from MAPFREQOA.dbo.T_MAE_POLIZA
--SELECT * FROM SGSM.dbo.TB_EMI_POLIZA
--select * from SGSM.dbo.TB_EMI_ITEM_POLIZA  where POLIZA_ID=40
--SELECT * FROM MAPFREQOA.dbo.T_DET_ROLTERCEROCERTIFICADO  WHERE N_ID_TIPOASEGURADO <> 640

--SUSCRIPCION
SELECT P.CANAL_ID, COUNT(*) 
FROM SGSM.dbo.TB_EMI_SUSCRIPCION P WITH(NOLOCK) 
WHERE P.CANAL_ID IN (11,12) 
group by P.CANAL_ID

select SC.N_ID_CANAL,COUNT(*)
from Mapfreqoa.DBO.T_MAE_SUSCRIPCION SC 
--INNER JOIN  MAPFREQOA.dbo.T_DET_ROLTERCEROSUSCRIPCION RS ON SC.N_ID_SUSCRIPCION=RS.N_ID_SUSCRIPCION
WHERE --RS.N_ID_TIPOASEGURADO <> 640 AND
SC.N_ID_CANAL IN (6,7)
group by SC.N_ID_CANAL


--SUSCRIPCION X CANTIDAD ASEGURADOS
--SELECT P.CANAL_ID, COUNT(*) 
--FROM SGSM.dbo.TB_EMI_SUSCRIPCION P WITH(NOLOCK) 
--JOIN SGSM.dbo. IPO WITH(NOLOCK) ON P.POLIZA_ID = IPO.POLIZA_ID --AND IPO.NRO_RIESGO <> 1
--JOIN SGSM.dbo.TB_EMI_ASEGURADO ASE WITH(NOLOCK) ON IPO.ASEGURADO_ID = ASE.ASEGURADO_ID
--WHERE P.CANAL_ID IN (11,12) 
--group by P.CANAL_ID


--select SC.N_ID_CANAL,COUNT(*)
--from Mapfreqoa.DBO.T_MAE_SUSCRIPCION SC 
----INNER JOIN  MAPFREQOA.dbo.T_DET_ROLTERCEROSUSCRIPCION RS ON SC.N_ID_SUSCRIPCION=RS.N_ID_SUSCRIPCION
--WHERE --RS.N_ID_TIPOASEGURADO <> 640 AND
--SC.N_ID_CANAL IN (6,7)
--group by SC.N_ID_CANAL


--SUSCRIPCION X AÑO
SELECT P.CANAL_ID, year(p.FEC_EMITE), COUNT(*) 
FROM SGSM.dbo.TB_EMI_SUSCRIPCION P WITH(NOLOCK) 
WHERE P.CANAL_ID IN (11,12) 
group by P.CANAL_ID,year(p.FEC_EMITE)
order by 1,2

select SC.N_ID_CANAL,year(SC.D_FEC_SUSCRIPCION), COUNT(*)
from Mapfreqoa.DBO.T_MAE_SUSCRIPCION SC 
--INNER JOIN  MAPFREQOA.dbo.T_DET_ROLTERCEROSUSCRIPCION RS ON SC.N_ID_SUSCRIPCION=RS.N_ID_SUSCRIPCION
WHERE --RS.N_ID_TIPOASEGURADO <> 640 AND
SC.N_ID_CANAL IN (6,7)
group by SC.N_ID_CANAL,year(SC.D_FEC_SUSCRIPCION)
order by 1,2


--SUSCRIPCION X PUNTO DE VENTA
SELECT P.CANAL_ID, SUVPOL.NOMBRE, COUNT(*) 
FROM SGSM.dbo.TB_EMI_SUSCRIPCION P WITH(NOLOCK) 
JOIN SGSM.dbo.TB_ADM_SUCURSAL SUVPOL WITH(NOLOCK) ON P.SUCURSAL_ID = SUVPOL.SUCURSAL_ID
WHERE P.CANAL_ID IN (11) 
group by P.CANAL_ID,SUVPOL.nombre
order by 2 ASC


select SC.N_ID_CANAL, EST.C_NOM_ESTABLECIMIENTO ,COUNT(*)
from Mapfreqoa.DBO.T_MAE_SUSCRIPCION SC 
JOIN MAPFREQOA.dbo.T_MAE_ESTABLECIMIENTO EST ON EST.N_ID_ESTABLECIMIENTO=SC.N_ID_ESTABLECIMIENTO
WHERE SC.N_ID_CANAL IN (7)
group by SC.N_ID_CANAL, EST.C_NOM_ESTABLECIMIENTO
order by 1 ASC

SELECT P.CANAL_ID, SUVPOL.NOMBRE, COUNT(*) 
FROM SGSM.dbo.TB_EMI_SUSCRIPCION P WITH(NOLOCK) 
JOIN SGSM.dbo.TB_ADM_SUCURSAL SUVPOL WITH(NOLOCK) ON P.SUCURSAL_ID = SUVPOL.SUCURSAL_ID
WHERE P.CANAL_ID IN (12) 
group by P.CANAL_ID,SUVPOL.nombre
order by 2 ASC


select SC.N_ID_CANAL, EST.C_NOM_ESTABLECIMIENTO ,COUNT(*)
from Mapfreqoa.DBO.T_MAE_SUSCRIPCION SC 
JOIN MAPFREQOA.dbo.T_MAE_ESTABLECIMIENTO EST ON EST.N_ID_ESTABLECIMIENTO=SC.N_ID_ESTABLECIMIENTO
WHERE SC.N_ID_CANAL IN (6)
group by SC.N_ID_CANAL, EST.C_NOM_ESTABLECIMIENTO
order by 1 ASC


/*
select TOP 100 * 
from Mapfreqoa.DBO.T_MAE_SUSCRIPCION SC 
INNER JOIN  MAPFREQOA.dbo.T_DET_ROLTERCEROSUSCRIPCION RS ON SC.N_ID_SUSCRIPCION=RS.N_ID_SUSCRIPCION
JOIN MAPFREQOA.dbo.T_MAE_ESTABLECIMIENTO EST ON EST.N_ID_ESTABLECIMIENTO=SC.N_ID_ESTABLECIMIENTO
WHERE RS.N_ID_TIPOASEGURADO <> 640
P.N_ID_CANAL IN (6)

SELECT * FROM SGSM.dbo.TB_EMI_SUSCRIPCION
SELECT * FROM MAPFREQOA.dbo.T_MAE_CANAL_PLAN
SELECT * FROM MAPFREQOA.dbo.T_MAE_ENTIDAD
SELECT * FROM MAPFREQOA.dbo.T_DET_ESTABLECIMIENTOTIPOCANAL

SELECT * FROM MAPFREQOA.dbo.T_DET_ROLTERCEROSUSCRIPCION WHERE N_ID_TIPOASEGURADO <> 640
SELECT * FROM MAPFREQOA.dbo.T_MAE_PLAN


SELECT * FROM MAPFREQOA.dbo.T_MAE_TIPO WHERE N_ID_TIPOPADRE=363
SELECT * FROM MAPFREQOA.dbo.T_MAE_TIPO WHERE N_ID_TIPOASEGURADO=363


SELECT  *
FROM SGSM.dbo.TB_EMI_POLIZA P WITH(NOLOCK)
JOIN SGSM.dbo.TB_EMI_ITEM_POLIZA IPO WITH(NOLOCK) ON P.POLIZA_ID = IPO.POLIZA_ID --AND IPO.NRO_RIESGO <> 1
JOIN SGSM.dbo.TB_EMI_ASEGURADO ASE WITH(NOLOCK) ON IPO.ASEGURADO_ID = ASE.ASEGURADO_ID
JOIN SGSM.dbo.TB_ADM_PERSONA PASE WITH(NOLOCK) ON ASE.PERSONA_ID = PASE.PERSONA_ID
JOIN SGSM.dbo.TB_ADM_PERSONA RESP WITH(NOLOCK) ON RESP.PERSONA_ID = P.RESPONSABLE_ID
JOIN SGSM.dbo.TB_ADM_PERSONA CONT WITH(NOLOCK) ON CONT.PERSONA_ID = P.CONTRATANTE_ID
WHERE P.CANAL_ID IN (11,12) 
AND NUMERO_UNICO ='9102158735'


SELECT * 
FROM MAPFREQOA.dbo.T_MAE_POLIZA P
JOIN MAPFREQOA.dbo.T_MAE_CERTIFICADO C ON P.N_ID_POLIZA = C.N_ID_POLIZA
JOIN MAPFREQOA.dbo.T_DET_ROLTERCEROCERTIFICADO RC ON RC.N_ID_CERTIFICADO=C.N_ID_CERTIFICADO --AND N_ID_TIPOASEGURADO <> 640
WHERE P.N_ID_CANAL IN (6,7) 
AND P.C_NUM_CERTIFICADOSOAT='9102158735'






LEFT JOIN SGSM.dbo.TB_ADM_DIRECCION_PERSONA DPASE WITH(NOLOCK) ON PASE.PERSONA_ID = DPASE.PERSONA_ID AND DPASE.MCA_PRINCIPAL = 'S'
LEFT JOIN SGSM.dbo.TB_ADM_DIRECCION DASE WITH(NOLOCK) ON DPASE.DIRECCION_ID = DASE.DIRECCION_ID
JOIN SGSM.dbo.TB_ADM_CIASEG CI WITH(NOLOCK) ON P.CIASEG_ID = CI.CIASEG_ID
JOIN SGSM.dbo.TB_ADM_CANAL CA WITH(NOLOCK) ON P.CANAL_ID = CA.CANAL_ID 
LEFT JOIN SGSM.dbo.TB_ADM_CATALOGO RA WITH(NOLOCK) ON P.RAMO_ID = RA.CATALOGO_ID AND RA.TIPO_CATALOGO_ID = 37

LEFT JOIN SGSM.dbo.TB_ADM_CATALOGO MO WITH(NOLOCK) ON P.MONEDA_ID = MO.CATALOGO_ID AND MO.TIPO_CATALOGO_ID = 28
LEFT JOIN SGSM.dbo.TB_ADM_PERSONA EN WITH(NOLOCK) ON P.ENDOSATARIO_ID = EN.PERSONA_ID
LEFT JOIN SGSM.dbo.TB_ADM_CATALOGO EMP WITH(NOLOCK) ON EN.TIPO_EMPRESA_ID = EMP.CATALOGO_ID AND EMP.TIPO_CATALOGO_ID = 29

JOIN SGSM.dbo.TB_ADM_VENDEDOR VE WITH(NOLOCK) ON P.VENDEDOR_ID = VE.VENDEDOR_ID

JOIN SGSM.dbo.TB_ADM_PUNTO_VENTA PVV WITH(NOLOCK) ON VE.PUNTO_VENTA_ID = PVV.PUNTO_VENTA_ID
JOIN SGSM.dbo.TB_ADM_SUCURSAL SUV WITH(NOLOCK) ON PVV.SUCURSAL_ID = SUV.SUCURSAL_ID

JOIN SGSM.dbo.TB_PRD_PRODUCTO PR WITH(NOLOCK) ON IPO.PRODUCTO_ID = PR.PRODUCTO_ID
JOIN SGSM.dbo.TB_PRD_PLAN PL WITH(NOLOCK) ON IPO.PLAN_ID = PL.PLAN_ID

JOIN SGSM.dbo.TB_ADM_PUNTO_VENTA PVP WITH(NOLOCK) ON VE.PUNTO_VENTA_ID = PVP.PUNTO_VENTA_ID
JOIN SGSM.dbo.TB_ADM_SUCURSAL SUP WITH(NOLOCK) ON PVP.SUCURSAL_ID = SUP.SUCURSAL_ID

LEFT JOIN SGSM.dbo.TB_ADM_CATALOGO FPA WITH(NOLOCK) ON P.FORMA_PAGO_ID = FPA.CATALOGO_ID 
LEFT JOIN SGSM.dbo.TB_ADM_PERSONA RESP WITH(NOLOCK) ON RESP.PERSONA_ID = P.RESPONSABLE_ID
LEFT JOIN SGSM.dbo.TB_ADM_PERSONA CONT WITH(NOLOCK) ON CONT.PERSONA_ID = P.CONTRATANTE_ID
LEFT JOIN SGSM.dbo.TB_ADM_DIRECCION_PERSONA DPCONT WITH(NOLOCK) ON CONT.PERSONA_ID = DPCONT.PERSONA_ID AND DPCONT.MCA_PRINCIPAL = 'S'
LEFT JOIN SGSM.dbo.TB_ADM_DIRECCION DCONT WITH(NOLOCK) ON DPCONT.DIRECCION_ID = DCONT.DIRECCION_ID
LEFT JOIN SGSM.dbo.TB_ADM_CATALOGO MOT WITH(NOLOCK) ON P.MOTIVO_ANULA_ID = MOT.CATALOGO_ID
LEFT JOIN SGSM.dbo.TB_CDA_USUARIO USU WITH(NOLOCK) ON P.USU_EMITE_ID = USU.USUARIO_ID
LEFT JOIN SGSM.dbo.TB_ADM_VENDEDOR USUV WITH(NOLOCK) ON USU.VENDEDOR_ID = USUV.VENDEDOR_ID


--SELECT * FROM TB_ADM_CANAL
*/